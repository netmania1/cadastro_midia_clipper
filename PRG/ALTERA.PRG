FUNCTION LPgrp_Altera()

TEL:=SAVESCREEN(05,01,21,80)
tel2:=savescreen(11,00,13,79)
COR:=SETCOLOR(_COR1)

SETCURSOR(1)

@ 05,01 CLEAR TO 21,79
@ 05,02 TO 21,79 DOUBLE

vmodelo=modelo
vtempo=tempo
vfita=fita
VHI_FI=HI_FI
VMIDIA=MIDIA
VSERIE=SERIE
VSOM=SOM
VROTACAO=ROTACAO
VTAMANHO=TAMANHO
VENCARTE=ENCARTE
REG=RECNO()
OLDTITULO=TITULO
OLDCONJUNTO=CONJUNTO
VTITULO=TITULO
VCONJUNTO=CONJUNTO
VCODIGO=CODIGO
VGRAV=GRA
VGRAVADORA=GRAVADORA
VFAIXA=FAIXA
VPROPRIEDA=PROPRIEDA
VPRESENTE=PRESENTE
VLOJA=LOJA
VVALOR=VALOR
VCOD_RITMO=COD_RITMO

@ 05,40 SAY '[Alterar]'
@ 06,03 SAY 'Titulo: '
@ 08,03 SAY 'Conjunto: '
@ 10,03 SAY 'C¢digo: '
@ 12,03 SAY 'Gravadora: '
@ 12,44 SAY 'N£mero de faixas: '
@ 14,03 SAY 'Valor do CD: R$' + SPACE(08) + 'Tipo de midia:'
@ 16,03 SAY 'Presente: '
@ 16,15 SAY 'Loja (Ou quem deu de presente): '
@ 18,03 SAY 'Propriedade: ' + space(16) + 'Ritmo:' + space(05) + ' - '
@ 20,03 SAY 'Registro incluido em: '
@ 20,36 SAY 'Registro alterado em: '

SETCOLOR('W+/B')
IF MIDIA = 'CD'
tmidia = "Compact Disc - CD"
ENDIF

IF MIDIA = 'LP'
tmidia = "Long Player - LP"
ENDIF

IF MIDIA = 'K7'
tmidia = "Fita Cassete - K7"
ENDIF

IF MIDIA = 'MD'
tmidia = "Mini Disc - MD"
ENDIF

IF MIDIA = 'VH'
tmidia = "Fita de Video VHS - VHS"
ENDIF

IF MIDIA = 'VC'
tmidia = "Fita de Video VHS-C - VHS-C"
ENDIF

IF MIDIA = 'SE'
tmidia = "Servico - SE"
ENDIF

IF MIDIA = 'EQ'
tmidia = "Equipamento Eletronico - EQ"
ENDIF

@ 14,40 SAY tmidia

SETCOLOR(_COR1)
@ 06,10 GET VTITULO PICTURE "@!" VALID(NOME_ALFA(VTITULO,"Titulo"))
@ 08,12 GET VCONJUNTO PICT '@!'
@ 10,10 GET VCODIGO PICT '@!'
@ 12,13 GET VGRAVADORA PICT '@!'
@ 12,61 GET VFAIXA PICT '99'
@ 14,18 GET VVALOR PICT '@E 9999.99'
@ 16,12 GET VPRESENTE PICT '@!' VALID VPRESENTE $ "SN"
@ 16,46 GET VLOJA PICT '@!S31'
@ 18,15 GET VPROPRIEDA PICT '@!'
@ 18,38 GET VCOD_RITMO PICTURE "99999" VALID(RITMO_PES())
@ 20,24 SAY INCLUI
@ 20,57 SAY ALTERA
READ

IF VMIDIA = "CD"
tel2:=savescreen(11,00,13,79)

@ 11,01 CLEAR TO 13,79
@ 11,01 TO 13,79 DOUBLE

@ 12,03 SAY 'Tipo de grava‡„o do CD:'
@ 12,26 GET VGRAV PICTURE "@!" VALID(TIPO_GRAV(12,26,VGRAV,_COR1))
read
setcursor(0)
inkey(3)
ENDIF

IF VMIDIA = "LP"
TEL2:=SAVESCREEN(05,01,21,80)

SETCURSOR(1)

@ 11,01 CLEAR TO 17,79
@ 11,02 TO 17,79 DOUBLE

@ 12,03 SAY 'Tamanho do Lp:' + space(03) + 'Rota‡”es por minuto (RPM):'
@ 14,03 SAY 'Serie:' + space(31) + 'Grava‡„o HI-FI ou Alta Fidelidade:'
@ 16,03 SAY 'Tipo de audio (Mono/Stereo):' + space(31) + 'Encarte: '

@ 12,17 GET VTAMANHO PICT '99'VALID(TIPO_TAMANHO(12,17,VTAMANHO,_COR1))
@ 12,46 GET VROTACAO PICTURE "99" VALID(TIPO_ROTACAO(12,46,VROTACAO,_COR1))
@ 14,09 GET VSERIE PICT '@!'
@ 14,74 GET VHI_FI PICT '@!' VALID VHI_FI $ "SN"
@ 16,31 GET VSOM PICTURE "@!K" VALID(TIPO_SOM(16,38,VSOM,_COR1))
@ 16,70 GET VENCARTE PICT '@!' VALID VENCARTE $ "SN"
read
ENDIF

IF VMIDIA = "K7"

tel2:=savescreen(09,00,17,79)

SETCURSOR(1)

@ 09,01 CLEAR TO 17,79
@ 09,02 TO 17,79 DOUBLE

@ 10,03 SAY 'Modelo da fita:'
@ 12,03 SAY 'Tempo de dura‡„o:'
@ 14,03 SAY 'Tipo de fita:'
@ 16,03 SAY 'Tipo de audio (Mono/Stereo):'
@ 10,18 GET vmodelo PICT '@!'
@ 12,20 GET vtempo PICT '999' VALID vtempo $ " 15, 30, 46, 50, 54, 60, 74, 90,100,120"
@ 14,16 GET VFITA PICTURE "@!K" VALID(TIPO_FITA(14,23,VFITA,_COR1))
@ 16,31 GET VSOM PICTURE "@!K" VALID(TIPO_SOM(16,38,VSOM,_COR1))
read
ENDIF

SETCURSOR(0)

IF LASTKEY()==27
RESTSCREEN(05,01,21,80,TEL2)
RESTSCREEN(05,01,21,80,TEL)
SETCOLOR(COR)
SETCURSOR(0)
RETURN(1)
ENDIF

IF Pergunta("Voce deseje alterar este registro? (S/N)",Cor4)<>"S"
   RESTSCREEN(05,01,21,80,TEL2)
   RESTSCREEN(05,01,21,80,TEL)
   RETURN
ENDIF

RESTSCREEN(05,01,21,80,TEL2)
RESTSCREEN(05,01,21,80,TEL)

REPLACE TITULO WITH VTITULO
REPLACE CONJUNTO WITH VCONJUNTO
REPLACE CODIGO WITH VCODIGO
REPLACE GRA WITH VGRAV
REPLACE GRAVADORA WITH VGRAVADORA
REPLACE FAIXA WITH VFAIXA
REPLACE PROPRIEDA WITH VPROPRIEDA
REPLACE ALTERA WITH date()
REPLACE VALOR WITH VVALOR
REPLACE PRESENTE WITH VPRESENTE
REPLACE LOJA WITH VLOJA
REPLACE MIDIA WITH VMIDIA
REPLACE ROTACAO WITH VROTACAO
REPLACE SOM WITH VSOM
REPLACE TAMANHO WITH VTAMANHO
REPLACE ENCARTE WITH VENCARTE
REPLACE HI_FI WITH VHI_FI
REPLACE TEMPO WITH VTEMPO
REPLACE FITA WITH VFITA
REPLACE MODELO WITH VMODELO
REPLACE COD_RITMO WITH VCOD_RITMO

select ritmo
goto top
set filter to
seek vcod_ritmo
if found()
vritmo = ritmo
select cadastro
replace ritmo with vritmo
endif
select cadastro

dbcommit()
salvareg=recno()
reggoto=recno()
LPgrp_Inicializa(salvareg)
