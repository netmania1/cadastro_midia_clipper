SELECT EMPRESTO

GOTO TOP

LOCATE FOR CODIGO = VCODIGO

IF .NOT. FOUND()
TEL61:=SAVESCREEN(09,13,14,65)
SETCOLOR(_COR4)
@ 09,23 CLEAR TO 11,53
@ 09,23 TO 11,53 DOUBLE
@ 10,25 SAY TEXTO11
TONE(1000,1)
INKEY(0)
RESTSCREEN(09,13,14,65,TEL61)
SETCOLOR(COR)
RETURN(0)
ELSE
*
ENDIF

LOCATE FOR CODIGO = VCODIGO

TEL61:=SAVESCREEN(05,01,21,80)
COR:=SETCOLOR(_COR1)

SETCURSOR(1)

@ 05,01 CLEAR TO 19,79
@ 05,02 TO 19,79 DOUBLE

@ 05,30 SAY TEXTO8
@ 06,03 SAY 'Nome da pessoa: '
@ 08,03 SAY 'Titulo: '
@ 10,03 SAY 'Conjunto: '
@ 12,03 SAY 'Data de saida original: '
@ 14,03 SAY 'Data de saida alterada para: '
@ 16,03 SAY 'Midia:'
@ 18,03 SAY 'Codigo:'

VNOME:=NOME
VSAIU:=DATE()

@ 06,18 GET VNOME PICTURE "@!" VALID(NOME_ALFA(VNOME,"Nome"))
@ 14,31 GET VSAIU
setcolor('w+/b')
@ 08,10 SAY TITULO
@ 10,12 SAY CONJUNTO
@ 12,26 SAY SAIU
@ 16,09 SAY VMIDIA
@ 18,10 SAY VCODIGO
READ

SETCURSOR(0)

IF LASTKEY()==27
RESTSCREEN(05,01,21,80,TEL61)
SETCOLOR(COR)
RETURN(2)
ENDIF

IF Pergunta("Voce confirma a alteracao do registro? (S/N)",Cor4)<>"S"
   RESTSCREEN(05,01,21,80,TEL61)
   RETURN
ENDIF

REPLACE NOME WITH VNOME
REPLACE SAIU WITH VSAIU
REPLACE DIAS WITH DATE() - VSAIU
dbcommit()

SELECT CADASTRO

GOTO TOP

LOCATE FOR REGISTRO = VCODIGO
REPLACE D_SAIU WITH VSAIU
REPLACE NEMPRESTO WITH VNOME
REPLACE EMPRESTADO WITH .T.
dbcommit()

RESTSCREEN(05,01,21,80,TEL61)
